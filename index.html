<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>–ö–∞—Ä—Ç–∞ –∏–º–ø–æ—Ä—Ç–æ–∑–∞–º–µ—â–µ–Ω–∏—è –Ω–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤–æ–≥–æ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏—è</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
  body { margin:0; font-family:Arial,sans-serif; }
  header {
    background:#1f4fa3;
    color:white;
    padding:10px;
    display:flex;
    gap:10px;
    align-items:center;
  }
  #map { height: calc(100vh - 60px); }

  select {
    padding:5px;
    font-size:14px;
  }

  .popup-img {
    width:100%;
    max-width:220px;
    margin-bottom:6px;
    border-radius:4px;
  }
</style>
</head>

<body>

<header>
  –ö–∞—Ä—Ç–∞ –∏–º–ø–æ—Ä—Ç–æ–∑–∞–º–µ—â–µ–Ω–∏—è
  <select id="typeFilter">
    <option value="all">–í—Å–µ —Ç–∏–ø—ã</option>
  </select>
  <select id="regionFilter">
    <option value="all">–í—Å–µ —Ä–µ–≥–∏–æ–Ω—ã</option>
  </select>
</header>

<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const map = L.map('map').setView([60, 90], 4);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
  attribution:'¬© OpenStreetMap'
}).addTo(map);

// üîπ –î–ê–ù–ù–´–ï –ó–ê–í–û–î–û–í
const factories = [
  {
    name: "–ì—Ä—É–ø–ø–∞ –ì–ú–°",
    city: "–ú–æ—Å–∫–≤–∞",
    region: "–ú–æ—Å–∫–≤–∞",
    type: "–ù–∞—Å–æ—Å—ã –∏ –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä—ã",
    coords: [55.7558, 37.6173],
    image: "images/gms.png",
    desc: "–ù–∞—Å–æ—Å—ã, –∫–æ–º–ø—Ä–µ—Å—Å–æ—Ä—ã –∏ –º–æ–¥—É–ª—å–Ω—ã–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏"
  },
  {
    name: "–£—Ä–∞–ª—Ö–∏–º–º–∞—à",
    city: "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥",
    region: "–°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    type: "–¢–µ–ø–ª–æ–æ–±–º–µ–Ω–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ",
    coords: [56.8389, 60.6057],
    image: "images/uralhim.png",
    desc: "–†–µ–∞–∫—Ç–æ—Ä—ã, –µ–º–∫–æ—Å—Ç–∏, —Ç–µ–ø–ª–æ–æ–±–º–µ–Ω–Ω–∏–∫–∏"
  },
  {
    name: "Borets",
    city: "–ß–µ–ª—è–±–∏–Ω—Å–∫",
    region: "–ß–µ–ª—è–±–∏–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
    type: "–°–∫–≤–∞–∂–∏–Ω–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ",
    coords: [55.1644, 61.4368],
    image: "images/borets.png",
    desc: "–ù–∞—Å–æ—Å—ã –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–æ–±—ã—á–∏"
  }
];

let markers = L.layerGroup().addTo(map);

// üîπ –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
const typeFilter = document.getElementById("typeFilter");
const regionFilter = document.getElementById("regionFilter");

[...new Set(factories.map(f => f.type))].forEach(t =>
  typeFilter.add(new Option(t, t))
);

[...new Set(factories.map(f => f.region))].forEach(r =>
  regionFilter.add(new Option(r, r))
);

// üîπ –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –º–∞—Ä–∫–µ—Ä–æ–≤
function render() {
  markers.clearLayers();

  factories.forEach(f => {
    if (
      (typeFilter.value !== "all" && f.type !== typeFilter.value) ||
      (regionFilter.value !== "all" && f.region !== regionFilter.value)
    ) return;

    const img = f.image || "images/default.png";

    const popup = `
      <img src="${img}" class="popup-img">
      <b>${f.name}</b><br>
      ${f.city}<br>
      <i>${f.type}</i><br>
      ${f.desc}
    `;

    L.marker(f.coords)
      .addTo(markers)
      .bindPopup(popup);
  });
}

typeFilter.onchange = render;
regionFilter.onchange = render;

render();
</script>

</body>
</html>